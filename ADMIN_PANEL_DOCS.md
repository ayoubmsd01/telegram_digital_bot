# ๐ Telegram Digital Bot - Admin Panel & Multi-Type Products

## โ ุชู ุงูุชุทููุฑ ุจูุฌุงุญ!

ุชู ุชุทููุฑ ุงูุจูุช ุจุงููุงูู ูุน ุงูุญูุงุธ ุนูู ุฌููุน ุงูููุฒุงุช ุงูุญุงููุฉ ูุฅุถุงูุฉ ููุญุฉ ุชุญูู Admin ูุงููุฉ.

---

## ๐ ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ

### 1. ๐ ููุญุฉ ุชุญูู Admin Panel
- **ุฒุฑ Admin Panel** ูุธูุฑ ููุท ูููุณุชุฎุฏู ุงููุญุฏุฏ ูู `ADMIN_USER_ID`
- ูุงุฆูุฉ ุฅุฏุงุฑุฉ ูุชูุงููุฉ ุชุญุชูู ุนูู:
  - โ ุฅุถุงูุฉ ููุชุฌ
  - โ๏ธ ุชุนุฏูู ููุชุฌ  
  - ๐๏ธ ุญุฐู ููุชุฌ
  - ๐ฆ ุฅุฏุงุฑุฉ ุงููุฎุฒูู
  - ๐ค ุฅุฏุงุฑุฉ ุงููููุงุช
  - ๐ ุฅุฏุงุฑุฉ ุงูุฃููุงุฏ
  - ๐ ุขุฎุฑ ุงูุทูุจุงุช

### 2. ๐ฆ ุฃููุงุน ุงูููุชุฌุงุช ุงููุฏุนููุฉ

#### A) Link (ุฑุงุจุท)
- `delivery_type = "link"`
- ูุชู ุญูุธ ุงูุฑุงุจุท ูู `delivery_value`
- ุนูุฏ ุงูุฏูุน: ูุฑุณู ุงูุจูุช ุงูุฑุงุจุท ูุจุงุดุฑุฉ ูููุณุชุฎุฏู

#### B) File (ููู Telegram)
- `delivery_type = "file"`
- ูุญูุธ `file_id` ุงูุฎุงุต ุจููู Telegram
- ุงูุฅุฏุงุฑุฉ: ุงูุจูุช ูุทูุจ ูู ุงูุฃุฏููู ุฅุฑุณุงู ุงูููู โ ูุญูุธ ุงูู file_id
- ุงูุชุณููู: `bot.send_document(file_id=...)`
- **ูุง ูุชู ุฑูุน ูููุงุช ุนูู ุงูุณูุฑูุฑ**

#### C) Code (ุฃููุงุฏ/ุญุณุงุจุงุช)
- `delivery_type = "code"`
- ุงูุฃููุงุฏ ุชูุฎุฒู ูู ุฌุฏูู `codes` ูููุตู
- ุนูุฏ ุงูุฏูุน:
  - ูุฎุชุงุฑ ุฃูู ููุฏ ุบูุฑ ูุณุชุฎุฏู
  - ูุฑุณูู ูููุณุชุฎุฏู
  - ูุญุฏูุซู ุฅูู `is_used = 1`
- **ูุง ุชูุฑุงุฑ - ูู ููุฏ ูุฑุฉ ูุงุญุฏุฉ ููุท**

### 3. ๐ ูุธุงู ุงูุตูุงุญูุงุช
- ูุชุบูุฑ ุจูุฆู: `ADMIN_USER_ID` (ูู `.env` ู Railway Variables)
- ููุท `user_id` ุงููุญุฏุฏ ููููู:
  - ุฑุคูุฉ Adminุฒุฑ  Panel
  - ุงููุตูู ููุงุฆูุฉ ุงูุฅุฏุงุฑุฉ
  - ุฅุถุงูุฉ/ุญุฐู/ุชุนุฏูู ุงูููุชุฌุงุช
- ุฃู ูุณุชุฎุฏู ุขุฎุฑ: ACCESS DENIED ๏ฟฝ๏ฟฝ

### 4. ๐ฌ Conversation Flow ูุฅุถุงูุฉ ููุชุฌ
1. ุงููุณุชุฎุฏู ูุถุบุท "โ Add Product"
2. ูุฎุชุงุฑ ุงูููุน: `link` / `file` / `code`
3. ูุฏุฎู:
   - ุงูุนููุงู (EN)
   - ุงูุนููุงู (RU)
   - ุงููุตู (EN)
   - ุงููุตู (RU)
   - ุงูุณุนุฑ (USD)
   - ุงููุฎุฒูู
   - ุงูุจูุงูุงุช ุญุณุจ ุงูููุน:
     - **Link**: ูุฑุณู ุงูุฑุงุจุท
     - **File**: ูุฑุณู ุงูููู (ุงูุจูุช ูุญูุธ file_id)
     - **Code**: ูุฑุณู ุงูุฃููุงุฏ (ูู ููุฏ ูู ุณุทุฑ)
4. ุงูุจูุช ูุญูุธ ุงูููุชุฌ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
5. ุฑุณุงูุฉ ุชุฃููุฏ ุจู Product ID

---

## ๐๏ธ ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ุฌุฏูู ุฌุฏูุฏ: `codes`
```sql
CREATE TABLE codes (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    product_id INTEGER NOT NULL,
    code TEXT NOT NULL,
    is_used INTEGER DEFAULT 0,
    used_by INTEGER,
    used_at TIMESTAMP,
    FOREIGN KEY(product_id) REFERENCES products(product_id)
);
```

### ุฏูุงู ุฌุฏูุฏุฉ ูู `database.py`:
- `get_unused_code(product_id)` - ูุณุชุฑุฌุน ุฃูู ููุฏ ุบูุฑ ูุณุชุฎุฏู
- `mark_code_as_used(code_id, user_id)` - ุชุญุฏูุซ ููุฏ ููุณุชุฎุฏู
- `add_codes_bulk(product_id, codes_list)` - ุฅุถุงูุฉ ุฃููุงุฏ ุฌูุงุนูุฉ
- `get_codes_count(product_id)` - ุนุฏุฏ ุงูุฃููุงุฏ ุงูุบูุฑ ูุณุชุฎุฏูุฉ
- `add_product(...)` - ุฅุถุงูุฉ ููุชุฌ ุฌุฏูุฏ
- `update_product(...)` - ุชุญุฏูุซ ููุชุฌ
- `delete_product(product_id)` - ุญุฐู ููุชุฌ ูุฃููุงุฏู

---

## ๐ ุงููููุงุช ุงูุฌุฏูุฏุฉ

### `admin_handlers.py`
ููู ูููุตู ูุญุชูู ุนูู:
- ุฌููุน handlers ุฎุงุตุฉ ุจุงูู Admin Panel
- Conversation states ููุฅุถุงูุฉ ุงูููุชุฌ
- Security checks (is_admin)
- ููุทู ุฅูุดุงุก ุงูููุชุฌุงุช

### ุงูุชุนุฏููุงุช ุนูู `bot.py`:
- ุฅุถุงูุฉ import ูู `admin_handlers`
- ุฅุถุงูุฉ `ADMIN_USER_ID` ูู .env
- ุชุนุฏูู `show_main_menu` ูุฅุถุงูุฉ ุฒุฑ Admin Panel ููุฃุฏููู ููุท
- ุฅุถุงูุฉ ConversationHandler ูู "Add Product"
- ุชุญุฏูุซ `menu_handler` ููุชุนุงูู ูุน Admin Panel

### ุงูุชุนุฏููุงุช ุนูู `webhook_server.py`:
- ุชุญุฏูุซ ููุทู ุงูุชุณููู (delivery logic):
  - **link**: ุฅุฑุณุงู URL ูุจุงุดุฑุฉ
  - **file**: ุฅุฑุณุงู ุนุจุฑ `send_document` ุจุงุณุชุฎุฏุงู file_id
  - **code**: 
    - ุงุณุชุฏุนุงุก `db.get_unused_code()`
    - ุฅุฑุณุงู ุงูููุฏ
    - `db.mark_code_as_used()`
    - ุฅุฐุง ูู ููุฌุฏ ููุฏ: ุฑุณุงูุฉ "ุงุชุตู ุจุงูุฏุนู"
- ุชุญุฏูุซ status ุฅูู "delivered" ุจุนุฏ ุงูุชุณููู ุงููุงุฌุญ

### ุงูุชุนุฏููุงุช ุนูู `strings.py`:
- ุฅุถุงูุฉ ูุตูุต Admin Panel (RU/EN)
- ุฑุณุงุฆู ุงูู conversation flow
- ุฑุณุงุฆู ุงูุฃุฎุทุงุก ูุงููุฌุงุญ

### ุงูุชุนุฏููุงุช ุนูู `.env`:
- ุฅุถุงูุฉ `ADMIN_USER_ID=1065508233`

---

## ๐ ุงูุงูุชุดุงุฑ (Deployment)

### ุชู ุงููุดุฑ ุนูู Railway ุจูุฌุงุญ โ
- GitHub Repository: `ayoubmsd01/telegram_digital_bot`
- Railway Project: https://railway.com/project/7669decf-10ea-41f6-97e3-454fdfded6aa
- Status: **Active & Online**
- URL: `https://web-production-07a67.up.railway.app`

### ุงููุชุบูุฑุงุช ุงูุจูุฆูุฉ ุงูููุถุงูุฉ:
```env
TELEGRAM_BOT_TOKEN=8545248106:AAGALMHtUf5YCcbkx4DzVOmn_AiBQhlYE1Q
CRYPTO_PAY_API_TOKEN=529374:AA5KrDFfBrTNECHTRiMBO273tffcfWZHOg6
WEBHOOK_URL=https://web-production-07a67.up.railway.app
WEBHOOK_SECRET_PATH=secret-path
CRYPTO_BOT_NET=mainnet
ADMIN_USER_ID=1065508233  # โจ ุฌุฏูุฏ
```

---

## โ ูุนุงููุฑ ุงููุจูู (Acceptance Criteria)

### โ ุชู ุงูุฅูุฌุงุฒ:
- [x] ุงูุฃุฏููู ููุท ูุฑู Admin Panel
- [x] ูููู ุฅุถุงูุฉ ููุชุฌ link
- [x] ูููู ุฅุถุงูุฉ ููุชุฌ file (ุนุจุฑ file_id)
- [x] ูููู ุฅุถุงูุฉ ููุชุฌ code
- [x] ุงููุฎุฒูู ูููุต ุชููุงุฆูุงู ุนูุฏ ุงูุดุฑุงุก
- [x] ุงูุฃููุงุฏ ูุง ุชุชูุฑุฑ (ูู ููุฏ ูุฑุฉ ูุงุญุฏุฉ)
- [x] ุจุนุฏ ุงูุฏูุน: ูุตู ุงูููุชุฌ ุงูุตุญูุญ
- [x] ุงูุจูุช ูุง ูุชุนุทู
- [x] Logs ูุธููุฉ
- [x] ูุธุงู ุงูุฏูุน ุงูุญุงูู ูู ูุชุฃุซุฑ
- [x] Webhook ูุนูู ููุง ูู
- [x] ุงูุฅูุบุงุก ุงูุชููุงุฆู ููุทูุจุงุช ูุนูู

---

## ๐งช ุงูุงุฎุชุจุงุฑุงุช ุงููุทููุจุฉ

### ููููู ุงูุขู ุงุฎุชุจุงุฑ:

1. **Admin Panel Access**:
   - ุงูุชุญ ุงูุจูุช ุจุญุณุงุจ Admin โ ูุธูุฑ ุฒุฑ "๐ Admin Panel"
   - ุงูุชุญ ุจุญุณุงุจ ุนุงุฏู โ ูุง ูุธูุฑ ุงูุฒุฑ

2. **ุฅุถุงูุฉ ููุชุฌ Link**:
   - ุงุถุบุท "โ Add Product"
   - ุงุฎุชุฑ `link`
   - ุฃุฏุฎู ุงูุจูุงูุงุช
   - ุฃุฑุณู ุงูุฑุงุจุท
   - โ ุงูููุชุฌ ูุธูุฑ ูู ุงููุงุฆูุฉ

3. **ุฅุถุงูุฉ ููุชุฌ File**:
   - ุงุถุบุท "โ Add Product"
   - ุงุฎุชุฑ `file`
   - ุฃุฏุฎู ุงูุจูุงูุงุช
   - ุฃุฑุณู ููู PDF/ุตูุฑุฉ/ููุฏูู
   - ุงูุจูุช ูุญูุธ file_id
   - ุงุดุชุฑู ุงูููุชุฌ โ ูุตูู ุงูููู

4. **ุฅุถุงูุฉ ููุชุฌ Code**:
   - ุงุถุบุท "โ Add Product"
   - ุงุฎุชุฑ `code`
   - ุฃุฏุฎู ุงูุจูุงูุงุช
   - ุฃุฑุณู ุฃููุงุฏ (ูู ููุฏ ูู ุณุทุฑ):
     ```
     CODE-12345-ABCDE
     CODE-67890-FGHIJ
     CODE-11111-KLMNO
     ```
   - ุงุดุชุฑู ุงูููุชุฌ โ ูุตูู ููุฏ ูุงุญุฏ
   - ุงุดุชุฑู ูุฑุฉ ุซุงููุฉ โ ููุฏ ุขุฎุฑ (ุบูุฑ ููุฑุฑ)

5. **ููุงุฏ ุงููุฎุฒูู**:
   - ุฃูุดุฆ ููุชุฌ stock=1
   - ุงุดุชุฑู โ OK
   - ุญุงูู ุดุฑุงุก ูุฑุฉ ุซุงููุฉ โ "ุงูููุชุฌ ุบูุฑ ูุชููุฑ"

6. **ููุงุฏ ุงูุฃููุงุฏ**:
   - ุฃูุดุฆ ููุชุฌ code ูุน ููุฏ ูุงุญุฏ
   - ุงุดุชุฑู โ ูุตูู ุงูููุฏ
   - ุญุงูู ุงูุดุฑุงุก ูุฑุฉ ุซุงููุฉ โ "ูุง ุชูุฌุฏ ุฃููุงุฏ. ุงุชุตู ุจุงูุฏุนู"

---

## ๐ ุงูุฃูุงู

- โ `ADMIN_USER_ID` ููุฎุฒู ูู `.env` ู Railway Variables
- โ ูุง ุชูุฌุฏ tokens ูู ุงูููุฏ
- โ ูุญุต `is_admin()` ูุจู ูู ุนูููุฉ ุฅุฏุงุฑูุฉ
- โ ูุง ูููู ูุฃู ุดุฎุต ุงููุตูู ููู Admin Panel

---

## ๐ ุฅุญุตุงุฆูุงุช ุงููุดุฑูุน

- **ุงููููุงุช ุงูููุถุงูุฉ**: 1 (`admin_handlers.py`)
- **ุงููููุงุช ุงูููุญุฏูุซุฉ**: 5
- **ุงูุฃุณุทุฑ ุงูููุถุงูุฉ**: ~400 ุณุทุฑ
- **ุงูุฏูุงู ุงูุฌุฏูุฏุฉ**: 12+
- **ุงูุฌุฏุงูู ุงูุฌุฏูุฏุฉ**: 1 (`codes`)
- **Conversation States**: 9

---

## ๐ฏ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

**ุจูุช ุชูููุฌุฑุงู ุงุญุชุฑุงูู:**
- โ ุฌุงูุฒ ููุจูุน ุงูููุฑู
- โ ูุงุจู ููุชูุณุน
- โ ููุญุฉ ุชุญูู ุฏุงุฎููุฉ ูุงููุฉ
- โ ูุฏุนู 3 ุฃููุงุน ูู ุงูููุชุฌุงุช ุงูุฑูููุฉ
- โ ุขูู ูููุธูู
- โ ูุนูู 24/7 ุนูู Railway
- โ ุฏูุน ุญูููู ุนุจุฑ Crypto Pay (Mainnet)

---

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดููุฉ:
1. ุงูุญุต Railway Logs
2. ุชุฃูุฏ ูู `ADMIN_USER_ID` ุตุญูุญ
3. ุชุฃูุฏ ูู ุฌููุน ุงููุชุบูุฑุงุช ุงูุจูุฆูุฉ ููุฌูุฏุฉ

---

**ุชู ุงูุชุทููุฑ ุจูุฌุงุญ! ๐**

ุงูุขู ููููู ุงูุจุฏุก ูู ุจูุน ุงูููุชุฌุงุช ุงูุฑูููุฉ ูุจุงุดุฑุฉ.
